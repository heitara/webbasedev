<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap      
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="inviteInfo">
	<typeAlias alias="inviteInfo" type="com.gameif.portal.entity.InviteInfo" />
	<typeAlias alias="deleteCondition" type="com.gameif.common.bean.ComSearchCondition" />
	
	<resultMap class="inviteInfo" id="inviteResult">
		<result property="inviteId" column="invite_id"/>
		<result property="memNum" column="mem_num"/>
		<result property="inviteMailFrom" column="invite_mail_from"/>
		<result property="inviteMailTo" column="invite_mail_to"/>
		<result property="inviteDate" column="invite_date"/>
		<result property="inviteMsg" column="invite_msg"/>
		<result property="titleId" column="title_id"/>
		<result property="inviteStatus" column="invite_status"/>
		<result property="friendCreateDate" column="friend_create_date"/>
		<result property="deleteFlag" column="delete_flag"/>
		<result property="createdDate" column="created_date"/>
		<result property="createdUser" column="created_user"/>
		<result property="lastUpdateDate" column="last_update_date"/>
		<result property="lastUpdateUser" column="last_update_user"/>
	</resultMap>
	
	<insert id = "save" parameterClass="inviteInfo">
		INSERT INTO invite_info
			(mem_num,
			invite_mail_from,
			invite_mail_to,
			invite_date,
			invite_msg,
			title_id,
			invite_status,
			friend_create_date,
			delete_flag,
			created_date,
			created_user,
			last_update_date,
			last_update_user)
		VALUES
			(#memNum#,
			#inviteMailFrom#,
			#inviteMailTo#,
			#inviteDate#,
			#inviteMsg#,
			#titleId#,
			#inviteStatus#,
			#friendCreateDate#,
			#deleteFlag#,
			#createdDate#,
			#createdUser#,
			#lastUpdateDate#,
			#lastUpdateUser#)
	</insert>

	<select id="selectInviteHistByMemNum" parameterClass="inviteInfo" resultMap="inviteResult">   
        <![CDATA[
        SELECT
			invite_id,
			mem_num,
			invite_mail_from,
			invite_mail_to,
			invite_date,
			invite_msg,
			title_id,
			invite_status,
			friend_create_date,
			delete_flag,
			created_date,
			created_user,
			last_update_date,
			last_update_user
		FROM
			invite_info
		WHERE
			mem_num = #memNum#
		AND delete_flag = '0'
        ]]>
        <isEqual compareProperty="inviteStatus" compareValue="0">
        	AND invite_status = '0'
        </isEqual>
        <isEqual compareProperty="inviteStatus" compareValue="1">
        	AND invite_status = '1'
        </isEqual>
	</select>
	
	<delete id="deleteInvalidInvite" parameterClass="deleteCondition">  
        <![CDATA[
        DELETE
		FROM
			invite_info
		WHERE
			mem_num = #memNum#
		AND delete_flag = '1'
		AND last_update_date < DATE_SUB(now(), INTERVAL #checkTime# DAY)
		
        ]]>
	</delete>


</sqlMap>